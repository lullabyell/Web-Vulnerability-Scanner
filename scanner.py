from sql_injection_detector import SQLInjectionDetector
from xss_detector import XSSDetector
from port_scanner import PortScanner
import utils.logger as logger

def main(url):
    logger.setup_logging()
    logger.log_info(f"Starting scan for {url}")
    
    # Initialize detectors
    sql_detector = SQLInjectionDetector(url)
    xss_detector = XSSDetector(url)
    port_scanner = PortScanner(url)

    # Run detectors
    sql_injections = sql_detector.scan()
    xss_vulnerabilities = xss_detector.scan()
    open_ports = port_scanner.scan()

    # Output results
    logger.log_info("Scan completed")
    logger.log_results(sql_injections, xss_vulnerabilities, open_ports)

if __name__ == "__main__":
    import sys
    if len(sys.argv) != 2:
        print("Usage: python scanner.py <url>")
    else:
        main(sys.argv[1])
