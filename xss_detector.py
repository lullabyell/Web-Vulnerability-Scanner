import requests
from bs4 import BeautifulSoup
from utils.request_handler import RequestHandler

class XSSDetector:
    def __init__(self, url):
        self.url = url
        self.request_handler = RequestHandler()

    def scan(self):
        payloads = ["<script>alert('XSS')</script>", "<img src='x' onerror='alert(1)'>"]
        vulnerabilities = []
        for payload in payloads:
            response = self.request_handler.send_get_request(self.url, params={"q": payload})
            if payload in response.text:
                vulnerabilities.append(payload)
        return vulnerabilities
