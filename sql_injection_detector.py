import requests
from utils.request_handler import RequestHandler

class SQLInjectionDetector:
    def __init__(self, url):
        self.url = url
        self.request_handler = RequestHandler()

    def scan(self):
        payloads = ["' OR '1'='1", "' OR '1'='1' -- "]
        vulnerabilities = []
        for payload in payloads:
            response = self.request_handler.send_get_request(self.url, params={"q": payload})
            if "syntax error" in response.text.lower() or "mysql" in response.text.lower():
                vulnerabilities.append(payload)
        return vulnerabilities
